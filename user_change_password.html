<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <?!= include('header') ?>
</head>

<body class="parent">
  <? var url = getUrl(); ?>
  <? if (userDetails.role == 'Admin') { ?>
  <nav class="p-4 flex flex-wrap justify-between items-center sticky top-0 z-50 border-b-[1px]"
    style="background-color: rgba(42, 40, 40, 0.2); backdrop-filter: blur(16px);">
    <div class="flex items-center mb-4 md:mb-0 w-full justify-between max-[800px]:mb-0">
      <img src="https://lh3.googleusercontent.com/drive-viewer/AKGpihbr1jUPEbB_FypVbwo5XnHDckfcb5iwTFCq7SgaTAEiQr5_Tf5qyVMtIKEnJjHEvTK2TstgNvLvBSjtypbJxUyRkXPPHFUJpA=s1600-rw-v1"
                alt="EZBOOK Logo" class="h-[60px] object-contain">
      <button id="profileButton" class="focus:outline-none h-12 w-12 flex items-center justify-center z-50">
                <img src="https://lh3.googleusercontent.com/drive-viewer/AKGpiha7I7athSkWWqVfCgZeiSgeHk39sZANsiMzg5K4EfLHgQWrvC-41XowMKHm__JluV-nkw9m-W55arJI9w3bG3XMJWiqrnKm3TQ=s2560"
                    alt="Profile" class="h-12 w-12 rounded-full">
            </button>
      <div id="profileMenu" class="dropdown-menu">
        <a href="<?=url?>?temp=user_profile">User Profile</a>
        <a href="<?=url?>?temp=user_change_password">Change Password</a>
        <form id="logoutForm" action="<?= ScriptApp.getService().getUrl() ?>" method="post">
          <input type="hidden" name="action" value="logout">
          <button type="submit">Logout</button>
        </form>
      </div>
    </div>
    <ul id="navItems"
      class="flex space-x-10 flex-wrap justify-end flex-grow  -mt-14 w-full max-[800px]:mt-4 max-[426px]:space-x-4 items-center justify-center">
      <li><a href="#" class="text-white hover:text-lime-500 lg:ml-16">Employee</a></li>
      <li><a href="#" class="text-white hover:text-lime-500">Customer</a></li>
      <li><a href="#" class="text-white hover:text-lime-500">Booking</a></li>
      <li><a href="#" class="text-white hover:text-lime-500">Invoice</a></li>
      <li><a href="#" class="text-white hover:text-lime-500">Service</a></li>
      <li><a href="#" class="text-white hover:text-lime-500">Report</a></li>
    </ul>
  </nav>
  <? } ?>
  <? if (userDetails.role == 'User') { ?>
  <nav class="p-4 flex flex-wrap justify-between items-center sticky top-0 z-50 border-b-[1px]"
    style="background-color: rgba(42, 40, 40, 0.2); backdrop-filter: blur(16px);">
    <div class="flex items-center mb-4 md:mb-0 w-full justify-between max-[800px]:mb-0">
      <img
        src="https://lh3.googleusercontent.com/drive-viewer/AKGpihbr1jUPEbB_FypVbwo5XnHDckfcb5iwTFCq7SgaTAEiQr5_Tf5qyVMtIKEnJjHEvTK2TstgNvLvBSjtypbJxUyRkXPPHFUJpA=s1600-rw-v1"
        alt="EZBOOK Logo" class="h-[60px] object-contain">
      <div class="flex items-center gap-0 sm:gap-6">
        <svg class="text-white w-10 h-10 cursor-pointer mr-2" xmlns="http://www.w3.org/2000/svg" fill="none"
          viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
        </svg>
        <button id="profileButton" class="focus:outline-none h-12 w-12 flex items-center justify-center z-50">
          <img
            src="https://lh3.googleusercontent.com/drive-viewer/AKGpiha7I7athSkWWqVfCgZeiSgeHk39sZANsiMzg5K4EfLHgQWrvC-41XowMKHm__JluV-nkw9m-W55arJI9w3bG3XMJWiqrnKm3TQ=s2560"
            alt="Profile" class="h-12 w-12 rounded-full">
        </button>
        <div id="profileMenu" class="dropdown-menu">
          <a href="<?=url?>?temp=user_profile">User Profile</a>
          <a href="<?=url?>?temp=user_change_password">Change Password</a>
          <form id="logoutForm" action="<?= ScriptApp.getService().getUrl() ?>" method="post">
            <input type="hidden" name="action" value="logout">
            <button type="submit">Logout</button>
          </form>
        </div>
      </div>
    </div>
  </nav>
  <? } ?>
  <div class="h-[74px] bg-[#2a282a] shadow-[8px_4px_4px_10px_#1d1c1d99]">
    <h1 class="text-lime-500 text-2xl pt-5 pl-5">Change Password</h1>
  </div>
  <!-- Content Section -->
  <div class="p-6 md:p-10 lg:p-14">
    <div class="mx-auto flex flex-col md:flex-row md:space-x-10 lg:gap-10">
      <!-- Profile Card -->
      <div class="p-8 rounded-lg shadow-lg flex flex-col items-center min-[1440px]:w-[390px] md:w-1/3 md:h-[425px]"
        style="background-color: #2A282A;">
        <div class="bg-gray-700 rounded-full flex items-center justify-center mb-4">
          <img src="https://lh3.googleusercontent.com/drive-viewer/AKGpiha7I7athSkWWqVfCgZeiSgeHk39sZANsiMzg5K4EfLHgQWrvC-41XowMKHm__JluV-nkw9m-W55arJI9w3bG3XMJWiqrnKm3TQ=s2560"
                        alt="Profile" class="rounded-full object-contain w-[200px]">
        </div>
        <div class="text-center">
          <h2 class="text-white mb-2">
            <?= userDetails.username ?>
          </h2>
          <h3 class="text-white">
            <?= userDetails.email ?>
          </h3>
        </div>
      </div>

      <!-- Change Password Form -->
      <div class="p-8 rounded-lg shadow-lg flex flex-col w-full md:flex-1">
        <form id="changePasswordForm" action="<?= url ?>" method="post">
          <input class="hidden" name="action" value="change_password">
          <div class="mb-10 relative">
            <label for="oldPassword" class="block text-white mb-2" style="font-family: ABeeZee;">Old
                            Password</label>
            <input type="password" id="oldPassword" name="oldPassword"
                            class="w-full px-3 py-2 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-400 md:w-3/4"
                            style="background-color: #323232;" required>
            <button type="button" id="toggleOldPassword"
                            class="absolute inset-y-0 right-0 pr-3 flex items-center mt-8 md:w-2/6 min-[1440px]:pl-8"
                            style="color: #f5f5f5;">
                            <svg id="eyeIconOldPassword" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                            </svg>
                        </button>
          </div>
          <div class="mb-10 relative">
            <label for="newPassword" class="block text-white mb-2" style="font-family: ABeeZee;">Create New
                            Password</label>
            <input type="password" id="newPassword" name="newPassword"
                            class="w-full px-3 py-2 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-400 md:w-3/4"
                            style="background-color: #323232;">
            <button type="button" id="toggleNewPassword"
                            class="absolute inset-y-0 right-0 pr-3 flex items-center mt-8 md:w-2/6  min-[1440px]:pl-8"
                            style="color: #f5f5f5;">
                            <svg id="eyeIconNewPassword" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                            </svg>
                        </button>
          </div>
          <div class="mb-10 relative">
            <label for="confirmPassword" class="block text-white mb-2" style="font-family: ABeeZee;">Confirm
                            New Password</label>
            <input type="password" id="confirmPassword" name="confirmPassword"
                            class="w-full px-3 py-2 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-lime-400 md:w-3/4"
                            style="background-color: #323232;">
            <button type="button" id="toggleConfirmNewPassword"
                            class="absolute inset-y-0 right-0 pr-3 flex items-center mt-8 md:w-2/6  min-[1440px]:pl-8"
                            style="color: #f5f5f5;">
                            <svg id="eyeIconConfirmNewPassword" xmlns="http://www.w3.org/2000/svg" fill="none"
                                viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                            </svg>
                        </button>
          </div>
          <? if (status == 'error') { ?>
          <div class="mb-2">
            <p class="text-red-500 font-bold" style="font-family: ABeeZee;">
              <?!= message ?>
            </p>
          </div>
          <? } ?>
          <? if (status == 'pass') { ?>
          <div class="mb-2">
            <p class="text-green-500 font-bold" style="font-family: ABeeZee;">
              <?!= message ?>
            </p>
          </div>
          <? } ?>
          <div class="flex justify-end">
            <button type="submit"
                            class=" w-full bg-[#D35833] hover:bg-orange-700 text-white py-2 px-4 rounded-lg md:w-1/4">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    // Toggle the dropdown menu
        document.getElementById('profileButton').addEventListener('click', function () {
            var menu = document.getElementById('profileMenu');
            menu.style.display = menu.style.display === 'none' || menu.style.display === '' ? 'block' : 'none';
        });

        // Close the dropdown menu when clicking outside of it
        window.onclick = function (event) {
            if (!event.target.matches('#profileButton') && !event.target.matches('#profileButton img')) {
                var dropdowns = document.getElementsByClassName('dropdown-menu');
                for (var i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.style.display === 'block') {
                        openDropdown.style.display = 'none';
                    }
                }
            }
        }
  </script>
  <script>
    document.getElementById('toggleOldPassword').addEventListener('click', function (e) {
            const passwordInput = document.getElementById('oldPassword');
            const eyeIcon = document.getElementById('eyeIconOldPassword');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
    </svg>`;
            } else {
                passwordInput.type = 'password';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
    </svg>`;
            }
        });
        document.getElementById('toggleNewPassword').addEventListener('click', function (e) {
            const passwordInput = document.getElementById('newPassword');
            const eyeIcon = document.getElementById('eyeIconNewPassword');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
    </svg>`;
            } else {
                passwordInput.type = 'password';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
    </svg>`;
            }
        });
        document.getElementById('toggleConfirmNewPassword').addEventListener('click', function (e) {
            const passwordInput = document.getElementById('confirmPassword');
            const eyeIcon = document.getElementById('eyeIconConfirmNewPassword');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
    </svg>`;
            } else {
                passwordInput.type = 'password';
                eyeIcon.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
      <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
    </svg>`;
            }
        });
  </script>
</body>

</html>